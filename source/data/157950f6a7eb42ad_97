From:
Rahul R <rahul13ramesh@gmail.com>

Date:
5-10-2016

Body:
I2luY2x1ZGUgPHN0ZGJvb2wuaD4KI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRsaWIu
aD4KI2luY2x1ZGUgPHB3ZC5oPgojaW5jbHVkZSA8dW5pc3RkLmg+CiNpbmNsdWRlIDxzdHJpbmcu
aD4KI2luY2x1ZGUgPHRlcm1jYXAuaD4KI2luY2x1ZGUgPGVycm5vLmg+CgojaW5jbHVkZSA8cmVh
ZGxpbmUvcmVhZGxpbmUuaD4KI2luY2x1ZGUgPHJlYWRsaW5lL2hpc3RvcnkuaD4KCiNkZWZpbmUg
TUFYX0NNRF9TSVpFIDEwMDAKI2RlZmluZSBNQVhfUEFUSCAxMDAKI2RlZmluZSBNQVhfVVNSIDMw
CgojZGVmaW5lIFNkSW5wIDAgCiNkZWZpbmUgU2RPdXQgMQoKCmludCBkZWZhdWx0X3N0ZG91dDsK
aW50IGRlZmF1bHRfc3RkaW47Cgp0eXBlZGVmIHN0cnVjdCBjbWRpewoJY2hhciAqY21kX3ZhbFtN
QVhfQ01EX1NJWkVdOwoJaW50IG51bV9jbWRzIDsKCWNoYXIgaW5wX2ZpbGVbNTBdOwoJY2hhciBv
dXRfZmlsZVs1MF07CglpbnQgaW5wX251bTsKCWludCBvdXRfbnVtOwoJc3RydWN0IGNtZGkgKm5l
eHQ7Cn0gY21kaW5mbzsKCnR5cGVkZWYgc3RydWN0IHRlbXB7CgljaGFyICp2YWw7CglzdHJ1Y3Qg
dGVtcCogbmV4dDsKfSB0b2tlbjsKCnRva2VuICpIZWFkOwp0b2tlbiAqVGFpbDsKCmNtZGluZm8g
KipnbG9iX2NtZF9waXBfaW5mOwppbnQgbnVtX2NtZF9waXA7CgppbnQgbWFpbih2b2lkKSB7CgoK
CWNoYXIgICAgICBob3N0bmFtZVsxMDBdOwoJLyogY2hhciAJICBsaW5lW01BWF9DTURfU0laRV07
ICovCgljaGFyCSAgKmxpbmU7CgoJc3RydWN0IAkgIHBhc3N3ZCAqcHc7Cgl1aWRfdCAgICAgdWlk
OwoJY2hhciAgICAgIHVzcm5hbWVbTUFYX1VTUl07CgljaGFyICAgICAgY3dkW01BWF9QQVRIXTsK
CWNoYXIgICAgICAqcHRoOwoJYm9vbCAgICAgIGN1cl9jb21tYW5kX3BpcGVfc3BsaXQgPSB0cnVl
OwoJYm9vbCAgICAgIGN1cl9jb21tYW5kbG5fZG9uZSA9IHRydWU7CgljaGFyICAgICAgcHJvbXB0
X21zZ1sxMDBdOwoKCXVpZF90ICAgICBnZXRldWlkKHZvaWQpOwoJY2hhciAgICAgICpnZXRjd2Qo
Y2hhciAqYnVmLCBzaXplX3Qgc2l6ZSk7Cgl2b2lkIAkgIHRva2VuaXplX2lucHV0KGNvbnN0IGNo
YXIgKmlucCk7Cgl2b2lkIAkgIGZyZWVfdG9rX21lbSgpOwoJdm9pZCAJICBzdGFydF9tZXNzYWdl
KCk7Cglib29sCSAgZXhlY19jbWQoaW50ICk7Cglib29sIAkgIHBhcnNlX2lucHV0KCk7Cgl2b2lk
IAkgIGluaXRfc3RkaW8oKTsKCXZvaWQgICAgICByZXN0b3JlX3N0ZGlvKCk7Cgl2b2lkICAgICAg
cGlwZV9mcmVlKCk7Cglib29sICAgICAgcGlwZV9zcGxpdCh0b2tlbiAqc3RhcnQsIHRva2VuICpl
bmQpOwoKCS8qIGdldCBIb3N0bmFtZSAqLwoJaG9zdG5hbWVbOTldID0gJ1wwJzsKCWdldGhvc3Ru
YW1lKGhvc3RuYW1lLCA5OSk7CgoJLyogR2V0IHVzZXJuYW1lICAqLwoJdWlkID0gZ2V0ZXVpZCAo
KTsKCXB3ID0gZ2V0cHd1aWQgKHVpZCk7CglzdHJjcHkodXNybmFtZSxwdy0+cHdfbmFtZSk7CgoJ
LyogU2F2ZSBTVERJTiwgU1RET1VUIGZpbGUgZGVzY3JpcHRvcnMgKi8KCWluaXRfc3RkaW8oKTsK
CglzdGFydF9tZXNzYWdlKCk7CgoJd2hpbGUoMSl7CgoJCXJlc3RvcmVfc3RkaW8oKTsKCgkJLyog
R2V0IGN1cnJlbnQgcGF0aCAqLwoJCXB0aCA9ICBnZXRjd2QoIGN3ZCwgTUFYX1BBVEggKTsKCgkJ
LyogUHJpbnQgcHJvbXB0ICovCgkJc3ByaW50Zihwcm9tcHRfbXNnLCAiJXNAJXM6JXMgJCAiLCB1
c3JuYW1lLGhvc3RuYW1lICxwdGgpOwoKCQkvKiBFeGl0IG9uIEN0cmwrRCAqLwoJCWlmKChsaW5l
ID0gcmVhZGxpbmUocHJvbXB0X21zZykpPT1OVUxMKQoJCQlleGl0KDApOwoJCQkKCQlpZihzdHJs
ZW4obGluZSk+NTEyKXsKCQkJcHJpbnRmKCJDb21tYW5kIGxlbmdodCBpcyB0b28gbG9uZ1xuIik7
CgkJCWNvbnRpbnVlOwoJCX0KCgoJCWN1cl9jb21tYW5kbG5fZG9uZSA9IGZhbHNlOwoKCQl0b2tl
bml6ZV9pbnB1dChsaW5lKTsKCgkJY3VyX2NvbW1hbmRfcGlwZV9zcGxpdCA9IHBpcGVfc3BsaXQo
SGVhZCwgVGFpbC0+bmV4dCk7CgkJaWYoY3VyX2NvbW1hbmRfcGlwZV9zcGxpdCkKCQkJcGlwZV9m
cmVlKCk7CgoJCS8qIGN1cl9jb21tYW5kX3N0YXR1cyA9IGV4ZWNfY21kKEhlYWQsIFRhaWwtPm5l
eHQpOyAqLwoKCQlmcmVlX3Rva19tZW0oKTsKCX0KCgkvKiBJbmRjYXRlIHByb2dyYW0gc3VjY2Vz
cyAqLwoJcmV0dXJuIDA7Cn0KCnZvaWQgcmVzdG9yZV9zdGRpbygpewoJZHVwMihkZWZhdWx0X3N0
ZG91dCwgMSk7CgljbG9zZShkZWZhdWx0X3N0ZG91dCk7CgoJZHVwMihkZWZhdWx0X3N0ZGluLCAw
KTsKCWNsb3NlKGRlZmF1bHRfc3RkaW4pOwoKCWRlZmF1bHRfc3Rkb3V0ID0gZHVwKDEpOwoJZGVm
YXVsdF9zdGRpbiA9IGR1cCgwKTsKfQoKdm9pZCBpbml0X3N0ZGlvKCl7CglkZWZhdWx0X3N0ZG91
dCA9IGR1cCgxKTsKCWRlZmF1bHRfc3RkaW4gPSBkdXAoMCk7Cn0KCnZvaWQgdG9rZW5pemVfaW5w
dXQoY29uc3QgY2hhciAqaW5wKXsKCWNoYXIgKnRrOwoJY2hhciAqYmFzZTsKCWNoYXIgKnN0cjsK
CWludCAgbGVuOwoJY2hhciBzeW1bNV07CglpbnQgIGk7CgoJdm9pZCBjcmVhdGVfbmV3X3Rva2Vu
KGNvbnN0IGNoYXIgKnRrX3N0cik7CgoJbGVuID0gc3RybGVuKGlucCk7CgoJc3RyID0gKGNoYXIg
KiltYWxsb2Moc2l6ZW9mKGNoYXIpICogKGxlbisyKSk7CgoJc3RyY3B5KHN0cixpbnApOwoKCS8q
IG9yaWdpbmFsIHN0cmluZyAqLwoJdGsgPSBzdHJ0b2sgKHN0ciwiIFx0XHIiKTsKCWJhc2UgPSB0
azsKCgoJd2hpbGUgKHRrICE9IE5VTEwpIHsKCgkJbGVuID0gc3RybGVuKHRrKTsKCgkJZm9yKGk9
MDsgaTxsZW47IGkrKyl7CgkJCWlmKHRrW2ldID09ICd8JyB8fCB0a1tpXSA9PSAnOycgfHwgdGtb
aV0gPT0gJzwnIHx8IHRrW2ldID09ICc+JyB8fCB0a1tpXSA9PSAnJicpewoJCQkJc3ltWzBdID0g
dGtbaV07CgkJCQlzeW1bMV0gPSAnXDAnOwoKCQkJCWlmKGkhPTApewoJCQkJCXRrW2ldID0gJ1ww
JzsKCQkJCQljcmVhdGVfbmV3X3Rva2VuKGJhc2UpOwoJCQkJfQoJCQkJY3JlYXRlX25ld190b2tl
bihzeW0pOwoJCQkJYmFzZSA9IHRrK2krMTsKCgkJCX0KCgkJCWVsc2UgaWYoaT09bGVuLTEpewoJ
CQkJY3JlYXRlX25ld190b2tlbihiYXNlKTsKCQkJfQoKCQl9CgoJCXRrID0gc3RydG9rIChOVUxM
LCAiIFx0XHJcbiIpOwoJCWJhc2UgPSB0azsKCX0KCglmcmVlKHN0cik7Cn0KCnZvaWQgY3JlYXRl
X25ld190b2tlbihjb25zdCBjaGFyICp0a19zdHIpewoKCWludCBsZW4gPSBzdHJsZW4odGtfc3Ry
KTsKCWNoYXIgKnRva192YWw7CiAgICB0b2tlbiAqbmV3X3RrOwoKCS8qIHJlbWVtYmVyIHRvIGZy
ZWUgYWxsIHRoZSBtYWxsb2NzKi8KCXRva192YWwgPSAoY2hhciAqKSBtYWxsb2Moc2l6ZW9mKGNo
YXIpICogKGxlbisyKSk7CgluZXdfdGsgPSAodG9rZW4gKikgbWFsbG9jKHNpemVvZih0b2tlbikg
KiAxKTsKCglzdHJjcHkodG9rX3ZhbCwgdGtfc3RyKTsKCgluZXdfdGstPnZhbCA9IHRva192YWw7
CgluZXdfdGstPm5leHQgPSBOVUxMOwoKCWlmKEhlYWQ9PU5VTEwpewoJCUhlYWQgPSBuZXdfdGs7
CgkJVGFpbCA9IG5ld190azsKCX0KCgllbHNlewoJCVRhaWwtPm5leHQgPSBuZXdfdGs7CgkJVGFp
bCA9IG5ld190azsKCX0KCn0KCnZvaWQgZnJlZV90b2tfbWVtKCl7CgoJdG9rZW4gKml0ZXIgPSBI
ZWFkOwoJdG9rZW4gKnRlbXA7CgoJd2hpbGUoaXRlciE9TlVMTCl7CgkJdGVtcCA9IGl0ZXI7CgkJ
aXRlciA9IGl0ZXItPm5leHQ7CgoJCWZyZWUodGVtcC0+dmFsKTsKCQlmcmVlKHRlbXApOwoJfQoK
CUhlYWQgPSBOVUxMOwoJVGFpbCA9TlVMTDsKfQoKdm9pZCBzdGFydF9tZXNzYWdlKCl7CgoJcHJp
bnRmKCJXZWxjb21lIHRvIE15U2giKTsKCXByaW50ZigiXG49PT09PT09PT09PT09PT1cbiIpOwoJ
cHJpbnRmKCJcblx0KiBUaGUgc3BlY2lhbCBzeWJtb2xzIGFyZSAnPicsICc8JywgJ3wnIGFuZCAm
JyAiKTsKCXByaW50ZigiXG5cdCogVXNlIFwiZXhpdFwiIGNvbW1hbmQgb3IgQ3RybCtEIHRvIGV4
aXQgdGhlIHRlcm1pbmFsXG5cbiIpOyAKfQoKdm9pZCBjZF9jbWQoaW50IGNtZF9ubyl7CglpbnQg
bnVtX2FyZ3MgPSAwOwoJdG9rZW4gKnRlbXA7CgljaGFyICpzdHI7CglpbnQgc3RhdHVzX2NkID0g
MDsKCWNtZGluZm8gKmN1cl9jbWQ7CgljaGFyICoqY21kX2xpc3Q7CglzdHJ1Y3QgcGFzc3dkICpw
dzsKCXVpZF90IHVpZDsKCWNoYXIgdXNybmFtZVtNQVhfVVNSXTsKCgl1aWRfdCBnZXRldWlkKHZv
aWQpOwoJY2hhciAqZ2V0Y3dkKGNoYXIgKmJ1Ziwgc2l6ZV90IHNpemUpOwoKCWN1cl9jbWQgPSBn
bG9iX2NtZF9waXBfaW5mW2NtZF9ub107CgludW1fYXJncyA9IGN1cl9jbWQtPm51bV9jbWRzOwoJ
Y21kX2xpc3QgPSBjdXJfY21kLT5jbWRfdmFsOwoKCWlmKG51bV9hcmdzIT0yKQoJCWZwcmludGYo
c3RkZXJyLCAicGxlYXNlIGVudGVyIGFuIGFyZ3VtZW50IGZvciBjZFxuIik7CgllbHNlewoJCXN0
ciA9IG1hbGxvYygyMDAgKiBzaXplb2YoY2hhcikpOwoKCQlpZihjbWRfbGlzdFsxXVswXSA9PSAn
ficpewoJCQl1aWQgPSBnZXRldWlkICgpOwoJCQlwdyA9IGdldHB3dWlkICh1aWQpOwoJCQlzdHJj
cHkodXNybmFtZSxwdy0+cHdfbmFtZSk7CgoJCQlzcHJpbnRmKCBzdHIsICIlcyVzJXMiLCAiL2hv
bWUvIiwgdXNybmFtZSwgKGNtZF9saXN0WzFdKSsxKTsKCQl9CgoJCWVsc2V7CgkJCXN0cmNweShz
dHIsIGNtZF9saXN0WzFdKTsKCQl9CgoJCXN0YXR1c19jZCA9IGNoZGlyKHN0cik7CgkJaWYoc3Rh
dHVzX2NkIT0wKXsKCQkJcHJpbnRmKCJFcnJvciBvY2N1cmVkIGluIGNkIDogSW52YWxpZCBkaXJl
Y3RvcnkgbmFtZVxuIik7CgkJfQoKCQlmcmVlKHN0cik7Cgl9CgoKfQoKdm9pZCBjbGVhcigpIHsK
CWNoYXIgYnVmWzEwMjRdOwoJY2hhciAqc3RyOwoKCXByaW50ZigiXDAzM1tIXDAzM1tKIik7Cn0g
CgovKiBUT0RPICovCi8qIFRoaXMgZnVuY3Rpb24gKi8KLyogQmFja2dyb3VuZCBwcm9jZXNzICov
CmJvb2wgY2FsbF9leGVjdl9mbihpbnQgbnVtKXsKCgp9Cgpib29sIGV4ZWNfY21kKGludCBjbWRf
bm8pewoJY21kaW5mbyAqY3VyX2NtZDsKCWNoYXIgKipjbWRfbGlzdDsKCglpbnQgaTsKCgljdXJf
Y21kID0gZ2xvYl9jbWRfcGlwX2luZltjbWRfbm9dOwoJY21kX2xpc3QgPSBjdXJfY21kLT5jbWRf
dmFsOwoKCglpZihzdHJjbXAoImNkIiwgY21kX2xpc3RbMF0pPT0wKQoJCWNkX2NtZChjbWRfbm8p
OwoJZWxzZSBpZiAoc3RyY21wKCJleGl0IiwgY21kX2xpc3RbMF0pPT0wKQoJCWV4aXQoMCk7Cgll
bHNlIGlmIChzdHJjbXAoImNsZWFyIiwgY21kX2xpc3RbMF0pPT0wKQoJCWNsZWFyKCk7CgllbHNl
ewoJCXJldHVybiBjYWxsX2V4ZWN2X2ZuKGNtZF9ubyk7Cgl9CgoJcmV0dXJuIHRydWU7Cn0KCmJv
b2wgcGlwZV9zcGxpdCh0b2tlbiAqc3RhcnQsIHRva2VuICplbmQpewoJdG9rZW4gKnRlbXA7Cglp
bnQgbnVtX3BpcGU9MDsKCWludCBjdXJfY21kID0gMDsKCWludCBpOwoJY2hhciB0bXBfY2g7CgoJ
Y2hhciBmX2luWzUwXTsKCWNoYXIgZl9vdXRbNTBdOwoKCWNtZGluZm8qIHByZXZfbmV4dDsKCWlu
dCBhcmdfbnVtOwoKCXZvaWQgaW5pdF9jbWRpbmYoY21kaW5mbyAqLCBpbnQpOwoKCS8qIEZpbmQg
bnVtYmVyIG9mIHBpcGVzICovCglmb3IodGVtcCA9IHN0YXJ0OyB0ZW1wIT1lbmQ7IHRlbXAgPSB0
ZW1wLT5uZXh0KXsKCQlpZiggKHRlbXAtPnZhbClbMF0gPT0gJ3wnKQoJCQludW1fcGlwZSsrOwoJ
fQoKCS8qIEluaXRpYWxpemUgc2V0IG9mIENvbW1hbmRzICovCgljbWRpbmZvICoqY21kczsKCWNt
ZHMgPSAoY21kaW5mbyAqKikgbWFsbG9jKCAoc2l6ZW9mKGNtZGluZm8gKikgKiAobnVtX3BpcGUg
KzEpKSk7Cglmb3IoaT0wOyBpPD1udW1fcGlwZTsgaSsrKXsKCQljbWRzW2ldID0gKGNtZGluZm8g
KikgbWFsbG9jKCAxICogc2l6ZW9mKGNtZGluZm8pKTsKCQljbWRzW2ldLT5pbnBfbnVtID0gMCA7
CgkJY21kc1tpXS0+b3V0X251bSA9IDAgOwoJCWNtZHNbaV0tPm51bV9jbWRzID0gMDsKCQljbWRz
W2ldLT5uZXh0ID0gTlVMTDsKCX0KCgl0ZW1wID0gc3RhcnQ7CgljdXJfY21kID0gMDsKCXByZXZf
bmV4dCA9IE5VTEwgOwoKCXdoaWxlKGN1cl9jbWQgPD1udW1fcGlwZSAmJiB0ZW1wICE9IE5VTEwp
ewoKCQlpZigodGVtcC0+dmFsKVswXSA9PSAnfCcpewoJCQkKCQkJaWYoY21kc1tjdXJfY21kXS0+
bnVtX2NtZHMgPT0gMCl7CgkJCQlwcmludGYoIlBhcnNlIEVycm9yIG9jY3VyZWQgOiBObyBjb21t
YW5kIGZvdW5kXG4iKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCQkKCQkJaWYoY3VyX2NtZCE9
MCkKCQkJCWNtZHNbY3VyX2NtZF0tPm5leHQgPSBwcmV2X25leHQ7CgoJCQlwcmV2X25leHQgPSBj
bWRzW2N1cl9jbWRdOwoJCQljdXJfY21kICsrOwoJCX0KCgkJZWxzZSBpZigodGVtcC0+dmFsKVsw
XSA9PSAnPicgfHwgKHRlbXAtPnZhbClbMF0gPT0gJzwnKXsKCgkJCXRtcF9jaCA9ICh0ZW1wLT52
YWwpWzBdOwoJCQl0ZW1wID0gdGVtcC0+bmV4dDsKCgkJCWlmKHRlbXAgPT0gTlVMTCB8fCB0ZW1w
LT52YWxbMF0gPT0gJzwnIHx8IHRlbXAtPnZhbFswXSA9PSAnfCcgfHwgdGVtcC0+dmFsWzBdID09
ICcmJyB8fCAgdGVtcC0+dmFsWzBdID09ICc+JyApewoJCQkJcHJpbnRmKCJQYXJzZSBFcnJvciBv
Y2N1cmVkIDogaW5jb3JyZWN0IHNlcXVlbmNlXG4iKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoK
CQkJaWYodG1wX2NoID09ICc8Jyl7CgkJCQljbWRzW2N1cl9jbWRdLT5pbnBfbnVtID0gMTsKCQkJ
CXN0cmNweShjbWRzW2N1cl9jbWRdLT5pbnBfZmlsZSwgdGVtcC0+dmFsKTsKCQkJfQoKCQkJZWxz
ZXsKCQkJCWNtZHNbY3VyX2NtZF0tPm91dF9udW0gPSAxOwoJCQkJc3RyY3B5KGNtZHNbY3VyX2Nt
ZF0tPm91dF9maWxlLCB0ZW1wLT52YWwpOwoJCQl9CgkJCgkJfQoKCQllbHNlewoJCQkoY21kc1tj
dXJfY21kXS0+Y21kX3ZhbClbY21kc1tjdXJfY21kXS0+bnVtX2NtZHNdID0gdGVtcC0+dmFsOwoJ
CQkoY21kc1tjdXJfY21kXS0+bnVtX2NtZHMpKys7CgkJfQoKCQl0ZW1wID0gdGVtcC0+bmV4dDsK
CX0KCglpZih0ZW1wICE9IE5VTEwpewoJCXByaW50ZigiUGFyc2UgRXJyb3Igb2NjdXJlZCA6IGVt
cHR5IHBpcGVcbiIpOwoJCXJldHVybiBmYWxzZTsKCX0KCWVsc2UgaWYoY21kc1tjdXJfY21kXS0+
bnVtX2NtZHMgPT0gMCl7CgkJcHJpbnRmKCJQYXJzZSBFcnJvciBvY2N1cmVkIDogTm8gY29tbWFu
ZFxuIik7CgkJcmV0dXJuIGZhbHNlOwoJfQoKCWdsb2JfY21kX3BpcF9pbmYgPSBjbWRzOwoJbnVt
X2NtZF9waXAgPSBudW1fcGlwZSArMTsKCglyZXR1cm4gdHJ1ZTsKCn0KCnZvaWQgcGlwZV9mcmVl
KCl7CglpbnQgaTsKCgljbWRpbmZvICoqY21kcyA9IGdsb2JfY21kX3BpcF9pbmY7CglpbnQgajsK
CWNoYXIgKngsKnk7CglpbnQgYSxiLGM7CgoJLyogcHJpbnRmKCIlZCBcbiIsbnVtX2NtZF9waXAp
OyAqLwoJZm9yKGk9MDtpPG51bV9jbWRfcGlwO2krKyl7CgkJLyogYSA9IGNtZHNbaV0tPmlucF9u
dW0gOyAqLwoJCS8qIGIgPSBjbWRzW2ldLT5vdXRfbnVtIDsgKi8KCQkvKiBjID0gY21kc1tpXS0+
bnVtX2NtZHM7ICovCgkJLyogeCA9IGNtZHNbaV0tPiBpbnBfZmlsZTsgKi8KCQkvKiB5ID0gY21k
c1tpXS0+IG91dF9maWxlOyAqLwoKCQkvKiBwcmludGYoImlucCwgb3V0LCBudW1fY21kICVkICVk
ICVkIFxuICIsIGEsYixjKTsgKi8KCQkvKiBpZihhKSAqLwoJCQkvKiBwcmludGYoImlucCAlcyBc
biIsIHgpOyAqLwoJCS8qIGlmKGIpICovCgkJCS8qIHByaW50Zigib3V0ICVzIFxuIiwgeSk7ICov
CgoJCS8qIGZvcihqPTA7ajxjO2orKykgKi8KCQkJLyogcHJpbnRmKCIlcyAiLCAoY21kc1tpXS0+
Y21kX3ZhbClbal0pOyAqLwoJCS8qIHByaW50ZigiXG5cbiIpOyAqLwoKCQkvKiBmcmVlKGNtZHNb
aV0pOyAqLwoJCWZyZWUoZ2xvYl9jbWRfcGlwX2luZltpXSk7Cgl9CglmcmVlKGdsb2JfY21kX3Bp
cF9pbmYpOwp9Cgpib29sIGV4ZWNfcGlwZSgpewoJaW50IGk7CglpbnQgbnVtX2NtZHM7CgoJLyog
MCBpcyByZWFkIGVuZCAgKi8KCS8qIDEgaXMgd3JpdGUgZW5kICovCgkvKiBSZWRpcmVjdGlvbiBm
cm9tIDEtPjAgKi8KCWludCBmaWxlX2Rlc2NbMl07CglpbnQgcHJldl9pbjsKCWludCBmaW5hbF9v
dXQgPSAxOwoKCgludW1fY21kcyA9IG51bV9jbWRfcGlwOwoJCgkvKiBTdGFydGluZyBpcyBTVERJ
TiAqLwoJcHJldl9pbiA9IDA7IAoKCWZvcihpPTA7IGk8bnVtX2NtZHMtMTsgaSsrKXsKCQlwaXBl
KGZpbGVfZGVzYyk7CgoJCS8qIFNURElOIGFuZCBwcmV2X2luIGFyZSBlcXZ0ICovCgkJZHVwMiAo
cHJldl9pbiwgU2RJbnApOwoKCQkvKiBTVERPVVQgYW5kIGZpbGVfZGVzY1sxXSBhcmUgZXF2dCAq
LwoJCWR1cDIoZmlsZV9kZXNjWzFdLCBTZE91dCk7CgoJCS8qIEV4ZWN1dGUgY29tbWFuZCAqLwoJ
CWV4ZWNfY21kKGkpOwoJCQoKCQkvKiBPbmx5IGlmIGNsb3NlZCwgd2lsbCBjb3Jlc3BvbmRpbmcg
ZmlsZV9kZXNjWzBdIHN0b3Agd2FpdGluZyBmb3IgcmVhZCAqLwoJCWNsb3NlKGZpbGVfZGVzY1sx
XSk7CgkJLyogQ2xvc2UgaW5wdXQgc2luY2UgZG9uZSB1c2luZyBpbnB1dCAqLwoJCWlmKHByZXZf
aW4hPTApCgkJCWNsb3NlKHByZXZfaW4pOwoKCQkvKiBub3RlIDogZmlsZV9kZXNjWzFdIC0+IGZp
bGVfZGVzY1swXSAqLwoJCS8qIEhlbmNlIG5leHQgaW5wdXQgaXMgZmlsZV9kZXNjWzBdICovCgkJ
cHJldl9pbiA9IGZpbGVfZGVzY1swXTsKCX0KCWV4ZWNfY21kKGkpOwoKfQo=

